<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Raster image processing: Raster Image Processing Console Editor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Raster image processing<span id="projectnumber">&#160;final</span>
   </div>
   <div id="projectbrief">Console editor for raster images</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Raster Image Processing Console Editor </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="intro"></a>
Introduction</h1>
<p>This project is a console-based raster image editor built for the course "Object-Oriented Programming" at FMI, 2025. It supports multiple raster formats <em>(PBM, PGM, PPM, BMP)</em> and allows the user to perform transformations on images Via a command-line interface. It includes session tracking, undo/redo functionality, image adding manipulation and transformation.</p>
<h1 class="doxsection"><a class="anchor" id="analysis"></a>
Task Breakdown and Problem-Solving Approach</h1>
<p>The development was broken into several key stages:</p><ul>
<li>Design of the core object model (images, files, sessions, commands).</li>
<li>Separation of console input parsing from core logic via a command handler mechanism.</li>
<li>Separating the file creation logic from the main image class.</li>
<li>Separating the command logic into: Session commands and Image commands.</li>
<li>Building a transformation system that supports chaining and undoing commands.</li>
<li>Separating the command execution proccess into three steps:<ul>
<li>Cloning images to ensure the original versions remain unchanged throughout the session.</li>
<li>Loading transformation metadata into each image's context.</li>
<li>Executing all recorded transformations based on the context.</li>
</ul>
</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="challenges"></a>
Challenges Encountered During Development</h1>
<p>During the development of this project, several non-trivial challenges arose, both architectural and algorithmic.</p>
<h2 class="doxsection"><a class="anchor" id="transformation_logic"></a>
Image Transformation and Transformation Identities</h2>
<p>One of the core challenges was designing a transformation system that could handle sequences of operations like rotation, flipping, and negation in a correct and efficient way. Many of these operations can cancel each other out or form geometric identities, for example:</p><ul>
<li>Rotating an image four times (360 degrees) results in the original state.</li>
<li>Flipping an image twice horizontally or vertically does nothing visually.</li>
<li>Combining rotations and flips can result in mirrored rotations that need careful ordering.</li>
</ul>
<p>To address this, a <em><span class="tt">Context</span></em> class was introduced to track all pending transformations per image. Instead of executing them immediately, the system defers them and applies them in a specific order during final execution. <b>Rotations must always be performed before flips</b>, as applying them out of order can lead to incorrect output. This strict transformation sequencing ensures correctness regardless of the order in which the user invokes commands.</p>
<h2 class="doxsection"><a class="anchor" id="command_storage"></a>
Memory Optimization and Shared Command Instances</h2>
<p>Another architectural decision involved how command instances are stored and reused. Instead of cloning or snapshotting every command for each image, which would lead to significant memory overhead, the system keeps one <b>static instance</b> per command type. All commands are executed by iterating over images at runtime rather than storing them individually for each image.</p>
<p>While this reduces memory usage significantly, it also introduced a new problem: <b>the loss of per-image command state</b>. To solve this, the transformation logic was decoupled from the commands themselves and moved into each image's <span class="tt">Context</span>. This preserved the separation of concerns, maintained low memory usage, and ensured that command execution remained stateless.</p>
<h2 class="doxsection"><a class="anchor" id="file_format_quirks"></a>
File Format Specific Issues</h2>
<p>Working with different image formats also brought implementation-specific issues. For example:</p><ul>
<li><b>BMP files</b> require padding each row to a multiple of 4 bytes.</li>
<li><b>PNM formats</b> (P4 binary in particular) use bit-packed data and allow interspersed comments that had to be ignored.</li>
<li>Some formats don't explicitly state dimensions in a friendly format, requiring robust token parsing.</li>
</ul>
<p>These were resolved through custom file readers/writers and careful stream management that complies with the specifications of each format.</p>
<h1 class="doxsection"><a class="anchor" id="architecture"></a>
Chosen Architecture and Design Rationale</h1>
<p>The system is intentionally built around <b>modularity, extensibility, and testability</b>, using several core design patterns:</p>
<ul>
<li><b>Command Pattern</b>: All transformations (e.g., <span class="tt">grayscale</span>, <span class="tt">rotate</span>, <span class="tt">negative</span>) are modeled as commands that can be executed, cloned, or undone. Each command encapsulates both metadata (<span class="tt">loadInfo</span>) and action (<span class="tt">execute</span>).</li>
<li><b>Factory Pattern</b>: Used for both <span class="tt">File</span> and <span class="tt">Command</span> creation. The <span class="tt">FileFactory</span> and <span class="tt">CommandFactory</span> are singletons that register format-specific and command-specific handlers, respectively.</li>
<li><b>Chain of Responsibility</b>: Implemented through <span class="tt">CommandHandler</span>, allowing input parsing to be handled flexibly without tightly coupling parsing logic to command logic. This also enables easy extension via new handlers.</li>
<li><b>Session Model</b>: The <span class="tt">Session</span> class acts as the core coordinator, holding a list of images and a command history (with undo/redo stacks). It isolates user interaction from internal state manipulation.</li>
<li><b>Matrix Abstraction</b>: The <span class="tt">Matrix</span> class provides an abstract view over a 2D array of pixels with built-in transformation methods such as <span class="tt">rotateLeft</span>, <span class="tt">rotateRight</span>, <span class="tt">flipHorizontal</span>, <span class="tt">paste</span>, and more. This ensures that image-level operations are cleanly separated from command logic.</li>
<li><b>Context Propagation</b>: The <span class="tt">Context</span> class holds all pending transformation states for an image before they are applied. This enables deferred execution of operations and batch application of transformations.</li>
</ul>
<p>This architecture allows the system to:</p><ul>
<li>Add new commands or formats without modifying existing code.</li>
<li>Decouple file reading/writing from business logic.</li>
<li>Track image state changes over time with minimal coupling.</li>
<li>Support undo/redo without overhead on individual commands.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="classes"></a>
Overview of Core Classes</h1>
<ul>
<li><span class="tt">Image</span> - Represents an individual raster image and its state, including its matrix and transformation context.</li>
<li><span class="tt">Matrix</span> - Encapsulates the 2D grid of pixels and provides the core transformation algorithms.</li>
<li><span class="tt">File</span> - Abstract base class for file format loaders and savers; extended by <span class="tt">BMP</span>, <span class="tt">PNM</span>, etc.</li>
<li><span class="tt">FileManager</span> - Interface for identifying and creating the correct file handler.</li>
<li><span class="tt">Session</span> - Manages the current editing session, list of images, and command history.</li>
<li><span class="tt">Command</span> - Abstract interface for all commands (<span class="tt">execute</span>, <span class="tt">clone</span>, <span class="tt">parseArguments</span>, etc.).</li>
<li><span class="tt">CommandHandler</span> - Responsible for parsing and returning command instances from user input.</li>
<li><span class="tt">FileFactory</span> / <span class="tt">CommandFactory</span> - Singleton classes that register and instantiate handlers.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="improvements"></a>
Ideas for Future Enhancements</h1>
<ul>
<li>Add support for more complex image formats (e.g., PNG, JPG).</li>
<li>Implement heavy transformations functionallity (e.g., large rotations).</li>
<li>Improve error handling with file-level and image-level diagnostics.</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="tooling"></a>
Documentation and Tooling</h1>
<p>This documentation is automatically generated using <b>Doxygen</b>, based on in-code comments. Class inheritance diagrams and call graphs are rendered using <b>Graphviz</b>. <br  />
 The full class hierarchy can be found in the "Classes" section of this documentation. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
